<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Power Guard | Data Injector</title>
    <style>
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: #1e293b; padding: 30px; border-radius: 12px; border: 1px solid #334155; width: 350px; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        h2 { margin-top: 0; color: #38bdf8; font-size: 1.2rem; text-align: center; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-size: 0.8rem; color: #94a3b8; }
        input { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box; font-size: 1rem; }
        button { width: 100%; padding: 12px; border: none; border-radius: 6px; background: #3b82f6; color: white; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #2563eb; }
        button:disabled { background: #475569; cursor: not-allowed; }
        #status { margin-top: 15px; text-align: center; font-size: 0.8rem; min-height: 1.2em; }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .preset-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
        .preset-btn { background: #334155; font-size: 0.7rem; padding: 8px; }
    </style>
</head>
<body>

<div class="card">
    <h2>üöÄ Data Injector</h2>
    <p style="font-size: 0.75rem; color: #64748b; text-align: center; margin-bottom: 20px;">Manual override for testing anomalies</p>
    
    <div class="input-group">
        <label>Frequency (Hz)</label>
        <input type="number" id="freq" step="0.01" value="50.00">
    </div>

    <div class="input-group">
        <label>Voltage (V)</label>
        <input type="number" id="volt" step="0.1" value="230.0">
    </div>

    <button id="sendBtn" onclick="injectData()">Inject Data Point</button>
    <div id="status"></div>

    <hr style="border: 0; border-top: 1px solid #334155; margin: 20px 0;">
    <label style="text-align: center;">Quick Presets</label>
    <div class="preset-grid">
        <button class="preset-btn" onclick="setValues(48.2, 230)">Low Freq</button>
        <button class="preset-btn" onclick="setValues(50, 195)">Low Volt</button>
        <button class="preset-btn" onclick="setValues(51.8, 230)">High Freq</button>
        <button class="preset-btn" onclick="setValues(50, 255)">High Volt</button>
    </div>
</div>

<script>
    // PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL HERE
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbydU2cT7eXUums153MSWc3l3AZDxN4kosGqM2bvBOP9KYce9mZos7d4v6jPStpSPdYY/exec";

    function setValues(f, v) {
        document.getElementById('freq').value = f;
        document.getElementById('volt').value = v;
    }

    async function injectData() {
        const btn = document.getElementById('sendBtn');
        const status = document.getElementById('status');
        const freq = document.getElementById('freq').value;
        const volt = document.getElementById('volt').value;

        btn.disabled = true;
        status.innerText = "Sending...";
        status.className = "";

        try {
            // Using no-cors mode is common for Google Script POSTs to avoid preflight issues
            // but the sheet will still receive the data if set to "Anyone"
            await fetch(SCRIPT_URL, {
                method: "POST",
                mode: "no-cors", 
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: `frequency=${freq}&voltage=${volt}`
            });

            status.innerText = "‚úÖ Data Injected Successfully";
            status.className = "success";
        } catch (e) {
            status.innerText = "‚ùå Error: " + e.message;
            status.className = "error";
        } finally {
            btn.disabled = false;
        }
    }
</script>

</body>
</html>
